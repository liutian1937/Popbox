(function(d){var n={id:!1,type:"pop",title:"消息提示",msg:"",mark:!0,width:400,height:"auto",init:!1,ready:!1,complete:!1,cancle:!1,close:!1,completeText:"确定",cancelText:"取消",loadingImg:"loading.gif",reload:!0},o={shake:function(a){var c=parseInt(a.css("left"));for(var b=1;4>=b;b++)a.animate({left:c-(12-3*b)+"px"},50),a.animate({left:c+2*(12-3*b)+"px"},50)},drag:function(c,b){var e=c.find(".popTitle"),h,j,k,l,f,i,m=function(a){a.stopPropagation(),a.preventDefault()},r=function(a){d(document).on("mousemove",p),d(document).on("mouseup",q),h=f=parseFloat(c.css("left")),j=i=parseFloat(c.css("top")),k=a.pageX,l=a.pageY,m(a)},p=function(a){c.addClass("dragActive"),f=h+a.pageX-k,i=j+a.pageY-l,f=f<=0?0:f,f=f>=b.limLeft?b.limLeft:f,i=i<=0?0:i,i=i>=b.limTop?b.limTop:i,c.css("left",f),c.css("top",i),m(a)},q=function(a){d(document).unbind("mousemove",p),d(document).unbind("mouseup",q),c.removeClass("dragActive"),m(a)};e.on("mousedown",r)}},s=function(a){var a=a||{},c=a.id?"Global_"+a.id:"Global_PopBox";if(!!window[c])return window[c].show(a),window[c];if(!(window[c]instanceof g))return window[c]=new g(a),window[c]},g=function(a){this.obj={},this.element=null,a.init&&typeof a.init=="function"&&a.init(),this.show(a)};g.fn=g.prototype,g.fn.show=function(a,c){var b=this,e;d("#popMark,.popBox").hide();if(b.element&&b.options.id&&!b.options.reload)return b.options.mark&&d("#popMark").show(),b.element.show(),!1;b.options=d.extend({},n,a),b.options.mark&&(d("#popMark").length<1&&d("body").append('<div id="popMark" style="z-index: 1999;"></div>'),d("#popMark").height(d(document).height()),d("#popMark").show());switch(a.type){case"alert":b.options.width=300,b.options.cancelText=!1,b.options.complete=function(){b.close()};break;case"confirm":b.options.width=300;break;case"prompt":b.options.width=300,b.options.msg='<form name="popForm"><ul class="formWrap popList"><div style="margin-left:0;margin-right:22px;"><input type="text" class="popInput" name="popInput" value="" style="width:100%;"></div></ul></form>'}b.element?(b.obj.titleObj.html(b.options.title),b.obj.bodyObj.html(b.options.msg)):b._1(b.options),b.obj.closeObj.on("click",function(){b.close()}),b.obj.bottomObj.html(""),b.options.completeText&&(b.obj.completeObj=d('<a href="javascript:void(0);" class="btn blue popComplete">'+b.options.completeText+"</a>"),b.obj.bottomObj.append(b.obj.completeObj),b.obj.completeObj.die("click"),b.obj.completeObj.on("click",function(){b._2()})),b.options.cancelText&&(b.obj.cancelObj=d('<a href="javascript:void(0);" class="btn gray popCancel">'+b.options.cancelText+"</a>"),b.obj.bottomObj.append(b.obj.cancelObj),b.obj.cancelObj.die("click"),b.obj.cancelObj.on("click",function(){b._3()})),b._4(),c!=="step"&&b._0(),d(window).on("resize",function(){b._0()}),b.element.show()},g.fn._1=function(a){var c=this,b,e,h,j,k;b=a.title||n.title,e=a.width=="auto"?"auto":a.width+"px",h=a.height=="auto"?"auto":a.height+"px",j="popBox "+c.options.type,k=c.options.id?c.options.id:"",c.element=d('<div class="'+j+'" id="'+k+'" style="width:'+e+";height:"+h+';"><a href="javascript:;" class="popClose">×</a><h3 class="yahei popTitle">'+b+'</h3><div class="popBody">'+a.msg+'</div><div class="popBottom"></div></div>'),c.obj.titleObj=c.element.find(".popTitle"),c.obj.bodyObj=c.element.find(".popBody"),c.obj.closeObj=c.element.find(".popClose"),c.obj.bottomObj=c.element.find(".popBottom"),d("body").append(c.element)},g.fn._5=function(){var a=this,c=a.element,b=a.options,e=b.width,h=b.height,j,k,l,f;isNaN(e)?function(){e="auto",l=c.width()}():function(){l=parseInt(e),e=parseInt(e)+"px"}(),isNaN(h)?function(){h="auto",f=c.height()}():function(){f=parseInt(h),h=parseInt(h)+"px"}(),j=(a.winSize.width-l)/2+"px",a.winSize.limLeft=a.winSize.width-l,k=(a.winSize.height-f)/2+"px",a.winSize.limTop=a.winSize.height-f,c.css({width:e,height:h,left:j,top:k})},g.fn._4=function(){var a=this,c=a.options.ready;c&&typeof c=="function"&&c.call(a)},g.fn._2=function(){var a=this,c=a.options.complete,b,e=!0;if(a.options.type=="prompt"){b=a.element.find(".popInput").val();if(b=="")return o.shake(a.element),!1}c&&typeof c=="function"&&(e=c.call(a,b)),e&&a.close()},g.fn._3=function(){var a=this,c=a.options.cancel,b=!0;c&&typeof c=="function"&&(b=c.call(a)),b&&a.close()},g.fn.close=function(){var a=this,c=a.options.close;c&&typeof c=="function"&&c.call(a),this.element.hide(),d("#popMark").hide()},g.fn._0=function(){var a=this;a.winSize={width:d(window).width(),height:d(window).height()},a._5(),o.drag(a.element,a.winSize)},g.fn.step=function(a){this.show(a,"step")},g.fn.loading=function(a,c){c=="end"?a.find(".popLoading").remove():a.find(".popLoading").length<1&&a.append('<div class="popLoading"><img src="'+this.options.loadingImg+'"></div>')},window.Pop=s})(jQuery)